<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siddhesh Ping Pro</title>
    <style>
        /* --- CORE STYLES (Kept exactly as you liked) --- */
        :root {
            --bg: #0b0f19; --card: #151a27; --primary: #3b82f6; --danger: #ef4444; 
            --text: #ffffff; --subtext: #94a3b8; --accent-glow: rgba(59, 130, 246, 0.5);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background-color: var(--bg); color: var(--text); height: 100vh; overflow: hidden; }
        
        /* --- SIDEBAR MENU STYLES --- */
        .menu-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 99; opacity: 0; pointer-events: none;
            transition: opacity 0.3s;
        }
        .menu-overlay.active { opacity: 1; pointer-events: auto; }
        
        .sidebar {
            position: fixed; top: 0; left: -280px; width: 260px; height: 100%;
            background: #1e293b; z-index: 100; transition: left 0.3s ease;
            padding: 20px; box-shadow: 2px 0 10px rgba(0,0,0,0.5);
            display: flex; flex-direction: column;
        }
        .sidebar.active { left: 0; }
        
        .menu-header { font-size: 20px; font-weight: 800; margin-bottom: 30px; color: white; border-bottom: 1px solid #334155; padding-bottom: 15px;}
        .menu-item {
            padding: 15px; margin-bottom: 10px; border-radius: 8px;
            color: #cbd5e1; text-decoration: none; font-weight: 600;
            display: flex; align-items: center; gap: 10px; transition: 0.2s;
        }
        .menu-item:hover, .menu-item.active { background: var(--primary); color: white; }
        .menu-icon { width: 24px; height: 24px; }

        /* --- APP SHELL --- */
        .app-shell { width: 100%; max-width: 450px; height: 100%; display: flex; flex-direction: column; padding: 20px; margin: 0 auto; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .hamburger { cursor: pointer; padding: 5px; }
        
        /* --- GAUGE & GRAPH (Your preferred UI) --- */
        .status-badge { font-size: 12px; background: #1e293b; padding: 4px 12px; border-radius: 20px; color: var(--subtext); display: flex; align-items: center; gap: 6px; }
        .dot { width: 8px; height: 8px; border-radius: 50%; background: #475569; }
        .dot.active { background: #22c55e; box-shadow: 0 0 8px #22c55e; }
        
        .gauge-container { position: relative; width: 260px; height: 260px; margin: 0 auto 30px auto; display: flex; align-items: center; justify-content: center; }
        .gauge-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
        .circle-bg { fill: none; stroke: #1e293b; stroke-width: 15; }
        .circle-progress { fill: none; stroke: var(--primary); stroke-width: 15; stroke-linecap: round; stroke-dasharray: 754; stroke-dashoffset: 754; transition: stroke-dashoffset 0.1s linear, stroke 0.3s; filter: drop-shadow(0 0 6px var(--accent-glow)); }
        
        .gauge-text { position: absolute; text-align: center; display: flex; flex-direction: column; align-items: center; }
        .ping-number { font-size: 64px; font-weight: 800; line-height: 1; font-variant-numeric: tabular-nums; }
        .ping-unit { font-size: 18px; color: var(--subtext); font-weight: 500; }
        .ping-label { font-size: 14px; color: var(--primary); margin-top: 5px; text-transform: uppercase; letter-spacing: 1px;}

        .graph-container { width: 100%; height: 80px; background: var(--card); border-radius: 12px; margin-bottom: 20px; position: relative; overflow: hidden; border: 1px solid #1e293b; }
        canvas { width: 100%; height: 100%; display: block; }

        .stats-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: auto; }
        .stat-box { background: var(--card); padding: 15px; border-radius: 12px; text-align: center; }
        .stat-label { font-size: 11px; color: var(--subtext); text-transform: uppercase; margin-bottom: 4px; }
        .stat-val { font-size: 18px; font-weight: 700; color: white; }

        .control-btn { width: 100%; padding: 18px; border-radius: 16px; font-size: 18px; font-weight: 700; border: none; cursor: pointer; transition: all 0.2s; background: var(--primary); color: white; box-shadow: 0 10px 30px -10px var(--accent-glow); margin-bottom: 20px; }
        .control-btn:active { transform: scale(0.98); }
        .control-btn.stop { background: var(--danger); box-shadow: 0 10px 30px -10px rgba(239, 68, 68, 0.4); }
        .footer { text-align: center; font-size: 13px; color: var(--subtext); padding-bottom: 10px; }
        .footer a { color: white; text-decoration: none; font-weight: 700; border-bottom: 1px dotted var(--subtext); }
    </style>
</head>
<body>

    <div class="menu-overlay" onclick="toggleMenu()"></div>
    <div class="sidebar" id="sidebar">
        <div class="menu-header">Ping Tools</div>
        <a href="index.html" class="menu-item active">
            <span>üåê</span> Standard Test
        </a>
        <a href="bgmi.html" class="menu-item">
            <span>üî´</span> BGMI / Gaming Test
        </a>
    </div>

    <div class="app-shell">
        <div class="header">
            <div class="hamburger" onclick="toggleMenu()">
                <svg width="28" height="28" fill="white" viewBox="0 0 24 24"><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>
            </div>
            <div class="status-badge">
                <div class="dot" id="status-dot"></div>
                <span id="connection-status">Idle</span>
            </div>
        </div>

        <div class="gauge-container">
            <svg class="gauge-svg" viewBox="0 0 250 250">
                <circle class="circle-bg" cx="125" cy="125" r="120"></circle>
                <circle class="circle-progress" cx="125" cy="125" r="120"></circle>
            </svg>
            <div class="gauge-text">
                <span class="ping-number" id="main-ping">0</span>
                <span class="ping-unit">ms</span>
                <span class="ping-label" id="ping-text">Ready</span>
            </div>
        </div>

        <div class="graph-container"><canvas id="pingCanvas"></canvas></div>

        <div class="stats-grid">
            <div class="stat-box"><div class="stat-label">Min</div><div class="stat-val" id="min-ping">--</div></div>
            <div class="stat-box"><div class="stat-label">Avg</div><div class="stat-val" id="avg-ping">--</div></div>
            <div class="stat-box"><div class="stat-label">Jitter</div><div class="stat-val" id="jitter-ping">--</div></div>
        </div>

        <button class="control-btn" id="toggle-btn" onclick="toggleTest()">Start Test</button>
        <div class="footer">Build by <a href="https://www.siddhesh.site" target="_blank">Siddhesh</a></div>
    </div>

    <script>
        function toggleMenu() {
            document.getElementById('sidebar').classList.toggle('active');
            document.querySelector('.menu-overlay').classList.toggle('active');
        }

        const TARGET_URL = "https://1.1.1.1/cdn-cgi/trace"; 
        let isRunning = false;
        let pings = [];
        
        const btn = document.getElementById('toggle-btn');
        const mainPingEl = document.getElementById('main-ping');
        const pingTextEl = document.getElementById('ping-text');
        const circle = document.querySelector('.circle-progress');
        const minEl = document.getElementById('min-ping');
        const avgEl = document.getElementById('avg-ping');
        const jitterEl = document.getElementById('jitter-ping');
        const canvas = document.getElementById('pingCanvas');
        const ctx = canvas.getContext('2d');
        let graphData = new Array(50).fill(0);

        function resizeCanvas() { canvas.width = canvas.parentElement.clientWidth; canvas.height = canvas.parentElement.clientHeight; }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        async function measurePing() {
            if (!isRunning) return;
            const start = performance.now();
            try {
                await fetch(`${TARGET_URL}?t=${Date.now()}`, { mode: 'no-cors', cache: 'no-store', method: 'HEAD' });
                let duration = performance.now() - start;
                // Standard browser adjustment
                if(duration > 5) duration = duration * 0.9; 
                const ping = Math.floor(duration);
                updateUI(ping);
                if(isRunning) setTimeout(measurePing, 500);
            } catch (error) { if(isRunning) setTimeout(measurePing, 1000); }
        }

        function updateUI(ping) {
            mainPingEl.innerText = ping;
            pings.push(ping);
            if(pings.length > 50) pings.shift();

            const min = Math.min(...pings);
            const avg = Math.floor(pings.reduce((a,b)=>a+b,0) / pings.length);
            const jitter = Math.floor(Math.abs(ping - avg));

            minEl.innerText = min;
            avgEl.innerText = avg;
            jitterEl.innerText = jitter;

            const circumference = 754; 
            const offset = circumference - ((Math.min(ping, 200) / 200) * circumference);
            circle.style.strokeDashoffset = offset;

            if(ping < 60) { circle.style.stroke = "#22c55e"; pingTextEl.innerText = "Excellent"; pingTextEl.style.color = "#22c55e"; }
            else if (ping < 120) { circle.style.stroke = "#f59e0b"; pingTextEl.innerText = "Fair"; pingTextEl.style.color = "#f59e0b"; }
            else { circle.style.stroke = "#ef4444"; pingTextEl.innerText = "Lagging"; pingTextEl.style.color = "#ef4444"; }

            updateGraph(ping);
        }

        function updateGraph(newPing) {
            graphData.push(newPing);
            graphData.shift();
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.beginPath();
            const stepX = canvas.width / (graphData.length - 1);
            const maxGraph = Math.max(...graphData, 100); 
            graphData.forEach((p, i) => {
                const x = i * stepX;
                const y = canvas.height - ((p / maxGraph) * canvas.height * 0.8) - 5; 
                if(i === 0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
            });
            ctx.strokeStyle = '#3b82f6'; ctx.lineWidth = 2; ctx.stroke();
            ctx.lineTo(canvas.width, canvas.height); ctx.lineTo(0, canvas.height);
            const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            gradient.addColorStop(0, "rgba(59, 130, 246, 0.3)"); gradient.addColorStop(1, "rgba(59, 130, 246, 0.0)");
            ctx.fillStyle = gradient; ctx.fill();
        }

        function toggleTest() {
            if(isRunning) {
                isRunning = false;
                btn.innerText = "Start Test"; btn.classList.remove('stop');
                document.getElementById('connection-status').innerText = "Paused";
                document.getElementById('status-dot').classList.remove('active');
            } else {
                isRunning = true; pings = [];
                btn.innerText = "Stop Test"; btn.classList.add('stop');
                document.getElementById('connection-status').innerText = "Connected";
                document.getElementById('status-dot').classList.add('active');
                measurePing();
            }
        }
    </script>
</body>
</html>
